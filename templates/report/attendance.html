{% extends "base.html" %}
{% block content %}

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/tempusdominus-bootstrap-4/5.0.1/js/tempusdominus-bootstrap-4.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tempusdominus-bootstrap-4/5.0.1/css/tempusdominus-bootstrap-4.min.css" />
<link rel="stylesheet" href="https://netdna.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.css" />

<div class="container my-3">
<form method="post" class="post-form">
    <div class='col-md-3 col-xs-4'>
        <div class="form-group">
            <div class="input-group date" id="datetimepicker1" data-target-input="nearest">
                <input type="text" class="form-control datetimepicker-input" data-target="#datetimepicker1" value="{{ month.firstDay }}">
                <div class="input-group-append" data-target="#datetimepicker1" data-toggle="datetimepicker">
                    <div class="input-group-text"><i class="fa fa-calendar"></i></div>
                </div>
            </div>
        </div>
    </div>
    <div class='col-md-3 col-xs-4'>
        <div class="form-group">
            <div class="input-group date" id="datetimepicker2" data-target-input="nearest">
                <input type="text" class="form-control datetimepicker-input" data-target="#datetimepicker2" value="{{ month.lastDay }}">
                <div class="input-group-append" data-target="#datetimepicker2" data-toggle="datetimepicker">
                    <div class="input-group-text"><i class="fa fa-calendar"></i></div>
                </div>
            </div>
        </div>
    </div>
    <div>
        <button class="btn btn-outline-secondary" type="button" id="btn_search">기간설정</button>
    </div>
</form>
    <h1>{{ today }}</h1>
    <table class="table">
    {% if data_list %}
        <thead>
        <tr class="thead-dark">
            <th>번호</th>
            <th>이름</th>
            <th>날짜</th>
            <th>출근</th>
            <th>퇴근</th>
            <th>근무시간</th>
            <th>상태</th>
            <th>사유</th>
        </tr>
        {% for data in data_list %}
        <tr>
            <td>{{ paging.offset + loop.index0 + 1}}</td>
            <td>{{ data.name }}</td>
            <td>{{ data.date }}</td>
            {% if data.begin %}
                <td>{{ data.begin[0:2] + ':' + data.begin[2:4] }}</td>
            {% else %}
                <td></td>
            {% endif %}
            {% if data.end %}
                <td>{{ data.end[0:2] + ':' + data.end[2:4]}}</td>
            {% else %}
                <td></td>
            {% endif %}
            {% if data.workingHours %}
                <td>{{ data.workingHours }}</td>
            {% else %}
                <td></td>
            {% endif %}
            {% if data.status[1] == 0 %}
                <td>{{ data.status[0] }}</td>
            {% else %}
                <td style='color:red'>{{ data.status[0] }}</td>
            {% endif %}
            <td>{{ data.reason }}</td>
        </tr>
        {% endfor %}
    {% else %}
        <tr>
            <td colspan="3">attend 정보가 없습니다.</td>
        </tr>
    {% endif %}
    </table>
</div>
{% include 'paging.html' %}
<script type="text/javascript">
    $(function () {
        $('#datetimepicker1').datetimepicker({ format: 'L'});
        $('#datetimepicker2').datetimepicker({ format: 'L', useCurrent: false });
        $("#datetimepicker1").on("change.datetimepicker", function (e) {
            $('#datetimepicker2').datetimepicker('minDate', e.date);
        });
        $("#datetimepicker2").on("change.datetimepicker", function (e) {
            $('#datetimepicker1').datetimepicker('maxDate', e.date);
        });
        $("#btn_search").on('click', function() {
        $("datetimepicker1").val($(this).val());
        $("datetimepicker2").val($(this).val());
        $("#searchForm").submit();
        });
    });
{% endblock %}