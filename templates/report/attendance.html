{% extends "base.html" %}
{% block content %}

<link rel="stylesheet" href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
<script src="//code.jquery.com/jquery-1.10.2.js"></script>
<script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
<script>
$(function() {
	$( ".dtpick" ).datepicker();
});
</script>

<div class="container my-3">
    {% include 'search.html' %}
    {% if start %}
    <h1>{{ start }} ~ {{ end }}</h1>
    {% else %}
    <h1>{{ today }}</h1>
    {% endif %}
    <form method="get" action="">
        {% include "form_errors.html" %}
        {{ form.start(class="dtpick") }}
        {{ form.end(class="dtpick") }}
        <button type="submit" class="btn btn-primary">기간</button>
    </form>
    <table class="table">
    {% if data_list %}
        <thead>
        <tr class="thead-dark">
            <th>번호</th>
            <th>이름</th>
            <th>날짜</th>
            <th>출근</th>
            <th>퇴근</th>
            <th>근무시간</th>
            <th>상태</th>
            <th>사유</th>
        </tr>
        {% for data in data_list %}
        <tr>
            <td>{{ paging.offset + loop.index0 + 1}}</td>
            {% if start %}
            <td><a href="{{ url_for('main.attend', name=data.name, start=start, end=end) }}">{{ data.name }}</a></td>
            {% else %}
             <td>{{ data.name }}</td>
            {% endif %}
            <td>{{ data.date }}</td>
            {% if data.begin %}
                <td>{{ data.begin[0:2] + ':' + data.begin[2:4] }}</td>
            {% else %}
                <td></td>
            {% endif %}
            {% if data.end %}
                <td>{{ data.end[0:2] + ':' + data.end[2:4]}}</td>
            {% else %}
                <td></td>
            {% endif %}
            {% if data.workingHours %}
                <td>{{ data.workingHours }}</td>
            {% else %}
                <td></td>
            {% endif %}
            {% if not data.status[0] %}
                <td></td>
            {% elif data.status[1] == 0 %}
                <td>{{ data.status[0] }}</td>
            {% else %}
                <td style='color:red'>{{ data.status[0] }}</td>
            {% endif %}
            <td>{{ data.reason }}</td>
        </tr>
        {% endfor %}
    {% else %}
        <tr>
            <td colspan="3">attend 정보가 없습니다.</td>
        </tr>
    {% endif %}
    </table>
    <table class="table">
    {% if summary %}
        <h1>summary</h1>
        <thead>
        <tr class="thead-dark">
            <th>기준일</th>
            <th>총근무시간</th>
            <th>정상출근</th>
            <th>지각</th>
            <th>미출근</th>
            <th>휴가</th>
            <th>연차</th>
            <th>반차</th>
            <th>출장</th>
            <th>외근</th>
            <th>기타</th>
        </tr>
        <tr>
            <td>{{ summary.totalDay }}</td>
            <td>{{ summary.totalWorkingHours }}</td>
            <td>{{ summary['정상출근'] }}</td>
            <td>{{ summary['지각'] }}</td>
            <td>{{ summary['미출근'] }}</td>
            <td>{{ summary['휴가'] }}</td>
            <td>{{ summary['연차'] }}</td>
            <td>{{ summary['반차'] }}</td>
            <td>{{ summary['출장'] }}</td>
            <td>{{ summary['외근'] }}</td>
            <td>{{ summary['기타'] }}</td>
        </tr>
    {% endif %}
    </table>
</div>
{% include 'paging.html' %}
{% endblock %}